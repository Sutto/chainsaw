var swfobject=function(){function g(){if(!B){try{var a=j.getElementsByTagName("body")[0].appendChild(x("span"));a.parentNode.removeChild(a)}catch(b){return}B=true;a=H.length;for(var c=0;c<a;c++)H[c]()}}function r(a){if(B)a();else H[H.length]=a}function k(a){if(typeof s.addEventListener!=l)s.addEventListener("load",a,false);else if(typeof j.addEventListener!=l)j.addEventListener("load",a,false);else if(typeof s.attachEvent!=l)ca(s,"onload",a);else if(typeof s.onload=="function"){var b=s.onload;s.onload=
function(){b();a()}}else s.onload=a}function n(){W?o():q()}function o(){var a=j.getElementsByTagName("body")[0],b=x(u);b.setAttribute("type",I);var c=a.appendChild(b);if(c){var d=0;(function(){if(typeof c.GetVariable!=l){var e=c.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");f.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else if(d<10){d++;setTimeout(arguments.callee,10);return}a.removeChild(b);c=null;q()})()}else q()}function q(){var a=y.length;if(a>0)for(var b=0;b<a;b++){var c=
y[b].id,d=y[b].callbackFn,e={success:false,id:c};if(f.pv[0]>0){var h=t(c);if(h)if(J(y[b].swfVersion)&&!(f.wk&&f.wk<312)){C(c,true);if(d){e.success=true;e.ref=D(c);d(e)}}else if(y[b].expressInstall&&Q()){e={};e.data=y[b].expressInstall;e.width=h.getAttribute("width")||"0";e.height=h.getAttribute("height")||"0";if(h.getAttribute("class"))e.styleclass=h.getAttribute("class");if(h.getAttribute("align"))e.align=h.getAttribute("align");var i={};h=h.getElementsByTagName("param");for(var m=h.length,p=0;p<
m;p++)if(h[p].getAttribute("name").toLowerCase()!="movie")i[h[p].getAttribute("name")]=h[p].getAttribute("value");R(e,i,c,d)}else{da(h);d&&d(e)}}else{C(c,true);if(d){if((c=D(c))&&typeof c.SetVariable!=l){e.success=true;e.ref=c}d(e)}}}}function D(a){var b=null;if((a=t(a))&&a.nodeName=="OBJECT")if(typeof a.SetVariable!=l)b=a;else if(a=a.getElementsByTagName(u)[0])b=a;return b}function Q(){return!K&&J("6.0.65")&&(f.win||f.mac)&&!(f.wk&&f.wk<312)}function R(a,b,c,d){K=true;S=d||null;X={success:false,
id:c};var e=t(c);if(e){if(e.nodeName=="OBJECT"){F=T(e);L=null}else{F=e;L=c}a.id=Y;if(typeof a.width==l||!/%$/.test(a.width)&&parseInt(a.width,10)<310)a.width="310";if(typeof a.height==l||!/%$/.test(a.height)&&parseInt(a.height,10)<137)a.height="137";j.title=j.title.slice(0,47)+" - Flash Player Installation";d=f.ie&&f.win?"ActiveX":"PlugIn";d="MMredirectURL="+s.location.toString().replace(/&/g,"%26")+"&MMplayerType="+d+"&MMdoctitle="+j.title;if(typeof b.flashvars!=l)b.flashvars+="&"+d;else b.flashvars=
d;if(f.ie&&f.win&&e.readyState!=4){d=x("div");c+="SWFObjectNew";d.setAttribute("id",c);e.parentNode.insertBefore(d,e);e.style.display="none";(function(){e.readyState==4?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)})()}U(a,b,c)}}function da(a){if(f.ie&&f.win&&a.readyState!=4){var b=x("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(T(a),b);a.style.display="none";(function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)})()}else a.parentNode.replaceChild(T(a),
a)}function T(a){var b=x("div");if(f.win&&f.ie)b.innerHTML=a.innerHTML;else if(a=a.getElementsByTagName(u)[0])if(a=a.childNodes)for(var c=a.length,d=0;d<c;d++)!(a[d].nodeType==1&&a[d].nodeName=="PARAM")&&a[d].nodeType!=8&&b.appendChild(a[d].cloneNode(true));return b}function U(a,b,c){var d,e=t(c);if(f.wk&&f.wk<312)return d;if(e){if(typeof a.id==l)a.id=c;if(f.ie&&f.win){var h="";for(var i in a)if(a[i]!=Object.prototype[i])if(i.toLowerCase()=="data")b.movie=a[i];else if(i.toLowerCase()=="styleclass")h+=
' class="'+a[i]+'"';else if(i.toLowerCase()!="classid")h+=" "+i+'="'+a[i]+'"';i="";for(var m in b)if(b[m]!=Object.prototype[m])i+='<param name="'+m+'" value="'+b[m]+'" />';e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+h+">"+i+"</object>";M[M.length]=a.id;d=t(a.id)}else{m=x(u);m.setAttribute("type",I);for(h in a)if(a[h]!=Object.prototype[h])if(h.toLowerCase()=="styleclass")m.setAttribute("class",a[h]);else h.toLowerCase()!="classid"&&m.setAttribute(h,a[h]);for(var p in b)b[p]!=
Object.prototype[p]&&p.toLowerCase()!="movie"&&ea(m,p,b[p]);e.parentNode.replaceChild(m,e);d=m}}return d}function ea(a,b,c){var d=x("param");d.setAttribute("name",b);d.setAttribute("value",c);a.appendChild(d)}function Z(a){var b=t(a);if(b&&b.nodeName=="OBJECT")if(f.ie&&f.win){b.style.display="none";(function(){b.readyState==4?fa(a):setTimeout(arguments.callee,10)})()}else b.parentNode.removeChild(b)}function fa(a){if(a=t(a)){for(var b in a)if(typeof a[b]=="function")a[b]=null;a.parentNode.removeChild(a)}}
function t(a){var b=null;try{b=j.getElementById(a)}catch(c){}return b}function x(a){return j.createElement(a)}function ca(a,b,c){a.attachEvent(b,c);E[E.length]=[a,b,c]}function J(a){var b=f.pv;a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?true:false}function $(a,b,c,d){if(!(f.ie&&f.mac)){var e=j.getElementsByTagName("head")[0];if(e){c=c&&typeof c=="string"?c:"screen";if(d)V=v=null;
if(!v||V!=c){d=x("style");d.setAttribute("type","text/css");d.setAttribute("media",c);v=e.appendChild(d);if(f.ie&&f.win&&typeof j.styleSheets!=l&&j.styleSheets.length>0)v=j.styleSheets[j.styleSheets.length-1];V=c}if(f.ie&&f.win)v&&typeof v.addRule==u&&v.addRule(a,b);else v&&typeof j.createTextNode!=l&&v.appendChild(j.createTextNode(a+" {"+b+"}"))}}}function C(a,b){if(aa){b=b?"visible":"hidden";if(B&&t(a))t(a).style.visibility=b;else $("#"+a,"visibility:"+b)}}function ba(a){return/[\\\"<>\.;]/.exec(a)!=
null&&typeof encodeURIComponent!=l?encodeURIComponent(a):a}var l="undefined",u="object",I="application/x-shockwave-flash",Y="SWFObjectExprInst",s=window,j=document,z=navigator,W=false,H=[n],y=[],M=[],E=[],F,L,S,X,B=false,K=false,v,V,aa=true,f=function(){var a=typeof j.getElementById!=l&&typeof j.getElementsByTagName!=l&&typeof j.createElement!=l,b=z.userAgent.toLowerCase(),c=z.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b);c=c?/mac/.test(c):/mac/.test(b);b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,
"$1")):false;var e=!+"\u000b1",h=[0,0,0],i=null;if(typeof z.plugins!=l&&typeof z.plugins["Shockwave Flash"]==u){if((i=z.plugins["Shockwave Flash"].description)&&!(typeof z.mimeTypes!=l&&z.mimeTypes[I]&&!z.mimeTypes[I].enabledPlugin)){W=true;e=false;i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1");h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10);h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10);h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof s.ActiveXObject!=l)try{var m=
new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(m)if(i=m.GetVariable("$version")){e=true;i=i.split(" ")[1].split(",");h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]}}catch(p){}return{w3:a,pv:h,wk:b,ie:e,win:d,mac:c}}();(function(){if(f.w3){if(typeof j.readyState!=l&&j.readyState=="complete"||typeof j.readyState==l&&(j.getElementsByTagName("body")[0]||j.body))g();if(!B){typeof j.addEventListener!=l&&j.addEventListener("DOMContentLoaded",g,false);if(f.ie&&f.win){j.attachEvent("onreadystatechange",
function(){if(j.readyState=="complete"){j.detachEvent("onreadystatechange",arguments.callee);g()}});s==top&&function(){if(!B){try{j.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}g()}}()}f.wk&&function(){B||(/loaded|complete/.test(j.readyState)?g():setTimeout(arguments.callee,0))}();k(g)}}})();(function(){f.ie&&f.win&&window.attachEvent("onunload",function(){for(var a=E.length,b=0;b<a;b++)E[b][0].detachEvent(E[b][1],E[b][2]);a=M.length;for(b=0;b<a;b++)Z(M[b]);for(var c in f)f[c]=
null;f=null;for(var d in swfobject)swfobject[d]=null;swfobject=null})})();return{registerObject:function(a,b,c,d){if(f.w3&&a&&b){var e={};e.id=a;e.swfVersion=b;e.expressInstall=c;e.callbackFn=d;y[y.length]=e;C(a,false)}else d&&d({success:false,id:a})},getObjectById:function(a){if(f.w3)return D(a)},embedSWF:function(a,b,c,d,e,h,i,m,p,G){var N={success:false,id:b};if(f.w3&&!(f.wk&&f.wk<312)&&a&&b&&c&&d&&e){C(b,false);r(function(){c+="";d+="";var A={};if(p&&typeof p===u)for(var w in p)A[w]=p[w];A.data=
a;A.width=c;A.height=d;w={};if(m&&typeof m===u)for(var O in m)w[O]=m[O];if(i&&typeof i===u)for(var P in i)if(typeof w.flashvars!=l)w.flashvars+="&"+P+"="+i[P];else w.flashvars=P+"="+i[P];if(J(e)){O=U(A,w,b);A.id==b&&C(b,true);N.success=true;N.ref=O}else if(h&&Q()){A.data=h;R(A,w,b,G);return}else C(b,true);G&&G(N)})}else G&&G(N)},switchOffAutoHideShow:function(){aa=false},ua:f,getFlashPlayerVersion:function(){return{major:f.pv[0],minor:f.pv[1],release:f.pv[2]}},hasFlashPlayerVersion:J,createSWF:function(a,
b,c){if(f.w3)return U(a,b,c)},showExpressInstall:function(a,b,c,d){f.w3&&Q()&&R(a,b,c,d)},removeSWF:function(a){f.w3&&Z(a)},createCSS:function(a,b,c,d){f.w3&&$(a,b,c,d)},addDomLoadEvent:r,addLoadEvent:k,getQueryParamValue:function(a){var b=j.location.search||j.location.hash;if(b){if(/\?/.test(b))b=b.split("?")[1];if(a==null)return ba(b);b=b.split("&");for(var c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("="))==a)return ba(b[c].substring(b[c].indexOf("=")+1))}return""},expressInstallCallback:function(){if(K){var a=
t(Y);if(a&&F){a.parentNode.replaceChild(F,a);if(L){C(L,true);if(f.ie&&f.win)F.style.display="block"}S&&S(X)}K=false}}}}(),JSSocket;
(function(){var g=function(k,n,o){this.id=++g.count;this.host=k;this.port=n;this.callbacks={};g.instances[this.id.toString()]=this;this.createInitialCallbacks();this.onLoad(o);this.createSocket()};g.instances={};g.count=0;g.enableDebug=true;g.swf="/flash/jsSocket.swf";g.logger=function(){console&&console.log&&console.log.apply(console,arguments)};g.debug=function(){g.enableDebug&&g.logger.apply(g,arguments)};g.connect=function(k,n,o){if(typeof o!="function")o=function(){};var q=new g(k,n,function(){o(q);
q.open()});return q};g.callback=function(k,n,o){setTimeout(function(){var q=g.instances[k.toString()];q&&q.callback(n,o)},0)};g.prototype={socket:null,callbacks:null,connected:false,createInitialCallbacks:function(){var k=this;this.onOpen(function(){k.connected=true});this.onClose(function(){k.connected=false})},callback:function(k,n){g.debug("Invoking callbacks for",k);var o=this.callbacks[k]||[],q=o.length;g.debug("Invoking",q,"callbacks for",k);for(k=0;k<q;k++)o[k](n)},defineCallback:function(k){this["on"+
k.replace(/^\w/,function(n){return n.toUpperCase()})]=function(n){this.callbacks.hasOwnProperty(k)||(this.callbacks[k]=[]);typeof n=="function"&&this.callbacks[k].push(n)}},createSocket:function(){g.debug("Creating socket for",this.id);var k="jssocket-"+this.id,n=document.createElement("div");n.id=k;var o=document.createElement("div");o.style.position="absolute";o.style.visibility="hidden";o.appendChild(n);document.body.appendChild(o);g.debug("Added a wrapper div to the page");n={id:this.id};o={style:"display: block;",
id:this.id};var q=this;g.debug("Preparing to embed the swf file");swfobject.embedSWF(g.swf,k,"1","1","9.0.0",false,n,{wmode:"transparent",bgcolor:"#ffffff",allowscriptaccess:"always"},o,function(D){if(D.success){g.debug("Embeded JSS.");q.socket=D.ref}else{g.debug("Embedding Failed.");q.callback("failedLoad")}})},send:function(k){g.debug("Sending data:",k);this.connected&&this.socket.send(k)},open:function(){g.debug("Attempting to connect...");if(!this.connected){g.debug("Socket wasn't open, actually connecting.");
this.socket.open(this.host,this.port)}},close:function(){g.debug("Closing socket if",this.connected);this.connected&&this.socket.close()}};var r=g.prototype;r.defineCallback("open");r.defineCallback("close");r.defineCallback("data");r.defineCallback("load");r.defineCallback("failedLoad");r.connect=r.open;r.disconnect=r.close;r.write=r.send;JSSocket=g})();
